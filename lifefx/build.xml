<project name="inet-lab Java Utilities" default="build">
  <property name="class-dir" value="build/classes"/>
  <property name="lib-dir" value="build/lib"/>
  <property name="jar-dir" value="build/jar"/>

  <path id="classpath">
    <fileset dir="${user.home}/Apps/javafx-sdk-14.0.1/lib" includes="*.jar"/>
  </path>

  <target name="clean">
    <delete dir="build"/>
  </target>

  <target name="compile">
    <mkdir dir="${class-dir}"/>
    <javac includeantruntime="false" debug="true" classpathref="classpath" srcdir="src" destdir="${class-dir}">
      <compilerarg value="-Xlint:deprecation"/>
    </javac>
  </target>

  <target name="build-jar" depends="compile">
    <mkdir dir="${jar-dir}"/>
    <jar destfile="${jar-dir}/lifefx.jar">
      <fileset dir="${class-dir}"/>
      <fileset dir="resources"/>
    </jar>
  </target>

  <target name="copy-libs">
    <mkdir dir="${lib-dir}"/>
    <copy file="../jni/liblifenative.dylib" todir="${lib-dir}"/>
  </target>

  <target name="build" depends="build-jar,copy-libs"/>

  <target name="run" depends="build">
    <java classname="net.inet_lab.life.ui.LifeUIMain" fork="true">
      <classpath>
        <path refid="classpath"/>
        <path location="${jar-dir}/lifefx.jar"/>
      </classpath>
      <sysproperty key="java.library.path" value="${lib-dir}"/>
      <jvmarg line="--module-path ${user.home}/Apps/javafx-sdk-14.0.1/lib --add-modules javafx.controls,javafx.fxml"/>
    </java>
  </target>
</project>